<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ask Gary - Architecture Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            background: #0f172a;
            color: #e5e7eb;
            padding: 40px;
        }
        h1 { 
            text-align: center; 
            color: #38bdf8; 
            margin-bottom: 40px;
            font-size: 2.5rem;
        }
        h2 { 
            color: #38bdf8; 
            margin: 40px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #1e293b;
        }
        .diagram-container {
            background: #1e293b;
            border-radius: 16px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        }
        .mermaid {
            display: flex;
            justify-content: center;
        }
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        .description {
            color: #9ca3af;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        @media print {
            body { background: white; color: black; }
            .diagram-container { box-shadow: none; border: 1px solid #ccc; }
            h1, h2 { color: #1e40af; }
        }
    </style>
</head>
<body>
    <h1>ðŸ¤– Ask Gary - Technical Architecture</h1>
    
    <h2>1. Solution Architecture Overview</h2>
    <p class="description">High-level view of all system components and their interactions.</p>
    <div class="diagram-container">
        <div class="mermaid" id="arch">
flowchart TB
    subgraph Internet["ðŸŒ Internet"]
        User["ðŸ‘¤ Visitors / Recruiters"]
        CF["â˜ï¸ Cloudflare CDN"]
    end

    subgraph AWS["â˜ï¸ AWS EC2 Instance"]
        subgraph Nginx["ðŸ”§ Nginx"]
            Static["ðŸ“„ Static Files"]
            Proxy["ðŸ”€ API Proxy"]
        end
        
        subgraph Frontend["ðŸ–¥ï¸ Frontend"]
            HTML["ðŸ“ ask-gary.html"]
            JS["âš¡ ask-gary.js"]
            CSS["ðŸŽ¨ styles.css"]
        end
        
        subgraph Backend["âš™ï¸ Backend - FastAPI"]
            Main["ðŸ main.py"]
            Config["âš™ï¸ config.py"]
            Index["ðŸ“Š indexed_data.json"]
        end
    end
    
    subgraph OpenAI["ðŸ¤– OpenAI API"]
        Embed["ðŸ”¢ Embeddings"]
        Chat["ðŸ’¬ GPT-4o-mini"]
    end

    User --> CF
    CF --> Nginx
    Static --> Frontend
    Proxy --> Backend
    JS --> Proxy
    Main --> Embed
    Main --> Chat
    Config --> Main
    Index --> Main
        </div>
    </div>

    <h2>2. Data Flow - User Query Processing</h2>
    <p class="description">Step-by-step flow of how a user question is processed and answered.</p>
    <div class="diagram-container">
        <div class="mermaid" id="flow">
sequenceDiagram
    autonumber
    participant U as ðŸ‘¤ User
    participant F as ðŸ–¥ï¸ Frontend
    participant B as âš™ï¸ Backend
    participant I as ðŸ“Š Knowledge Base
    participant O as ðŸ¤– OpenAI API

    U->>F: Types question
    F->>B: POST /chat
    B->>O: Generate query embedding
    O-->>B: Embedding vector
    B->>I: Similarity search
    I-->>B: Top 6 relevant chunks
    B->>O: Chat completion request
    O-->>B: Generated response
    B-->>F: Answer + sources
    F-->>U: Display response
        </div>
    </div>

    <h2>3. Technology Stack</h2>
    <p class="description">Overview of all technologies used across the stack.</p>
    <div class="diagram-container">
        <div class="mermaid" id="stack">
mindmap
  root((Ask Gary))
    Frontend
      HTML5
      CSS3
      JavaScript
      marked.js
    Backend
      Python
      FastAPI
      Uvicorn
      Pydantic
    Infrastructure
      AWS EC2
      Ubuntu
      Nginx
      systemd
      Cloudflare
    AI/ML
      GPT-4o-mini
      Embeddings API
      RAG
        </div>
    </div>

    <h2>4. Component Architecture</h2>
    <p class="description">Detailed view of frontend and backend components.</p>
    <div class="diagram-container">
        <div class="mermaid" id="components">
flowchart LR
    subgraph FE["Frontend Components"]
        direction TB
        A1["ask-gary.html<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ Chat UI<br/>â€¢ Dark theme<br/>â€¢ Responsive"]
        A2["ask-gary.js<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ Session mgmt<br/>â€¢ Retry logic<br/>â€¢ Animations"]
        A3["styles.css<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ CSS variables<br/>â€¢ Gradients<br/>â€¢ Transitions"]
    end

    subgraph BE["Backend Components"]
        direction TB
        B1["main.py<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ /health<br/>â€¢ /chat<br/>â€¢ RAG logic"]
        B2["config.py<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ System prompt<br/>â€¢ Model config<br/>â€¢ Chunk settings"]
        B3["indexed_data.json<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ Pre-computed<br/>â€¢ Embeddings<br/>â€¢ Source refs"]
    end

    subgraph Data["Knowledge Base"]
        direction TB
        D1["AboutMe.txt"]
        D2["Experience.txt"]
        D3["Projects.txt"]
        D4["Skills.txt"]
    end

    FE --> BE
    Data --> B3
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#38bdf8',
                primaryTextColor: '#fff',
                primaryBorderColor: '#1e40af',
                lineColor: '#38bdf8',
                secondaryColor: '#1e293b',
                tertiaryColor: '#0f172a',
                background: '#1e293b',
                mainBkg: '#1e293b',
                secondBkg: '#334155'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            }
        });
    </script>
</body>
</html>
